%% s3859061
clear
close all 
clc
set(0,'DefaultFigureWindowStyle','docked') 

A=[0,7;-1,4;4,2;-3,4;2,-1;-1,-2;2,-4;7,-3;4,6;7,3;8,0];
% A = [0,2;-3,3;0,5;-2,8;0,10;7,11;4,7;2,3;3,4];
[k1,av1] = convhull(A);

B=[11,9;15,12;12,6;16,8;7,14;12,15;9,12;8,9;8,9];
% B = [4,-5;8,-3;5,-7;14,-5;15,3;12,4;9,-1;8,0;6,-1];
[k2,av2] = convhull(B);

scatter(A(:,1), A(:,2), 'MarkerEdgeColor',[0 0 1]')

hold on
plot(A(k1,1),A(k1,2),'b')

scatter(B(:,1), B(:,2), 'MarkerEdgeColor',[1 0 0]')
plot(B(k2,1),B(k2,2),'r')

xl = xlabel('$x$');
yl = ylabel('$y$');
set([xl,yl],'Interpreter','LaTeX');
grid on
hold off


%% Choosing support vector through
s1 = [4;6;1]; % NEGATIVE CLASS
s2 = [7;3;1]; % NEGATIVE CLASS
s3 = [8;9;1]; % POSIRIVE CLASS

% s1 = [2;3;1]; % NEGATIVE CLASS
% s2 = [3;4;1]; % NEGATIVE CLASS
% s3 = [6;-1;1]; % POSIRIVE CLASS

classes = [-1;-1;1];

N = numel(classes);
SUPPORT_VECTORS = [s1 s2 s3];
COEFFICIENTS = zeros(N,N);

for i = 1:N
    for j = 1:N
        COEFFICIENTS(i,j) = dot(SUPPORT_VECTORS(:,j),...
            SUPPORT_VECTORS(:,i));
    end
end

ALPHAS = COEFFICIENTS\classes;
wTilde = zeros(N,1);

for n = 1:N
    wTilde = wTilde + ALPHAS(n)*SUPPORT_VECTORS(:,n);
end

w = wTilde(1:N-1);
b = wTilde(N);


%% Margin Calculation
WN = numel(w);
sumWSquare = 0;
for k = 1:WN
    sumWSquare = sumWSquare + w(k)^2;
end
d = 1/sqrt(sumWSquare);
m = 2*d;

%% Hyperplane line generation
plotAxises = axis;
x = plotAxises(1):1:plotAxises(2);

a = -1*(w(1)/w(2));
c = -1*(b/w(2));
y = a*x + c;

hold on 
plot(x, y, 'k', 'LineWidth', 3);

titleStr=sprintf("$y = (%g) x + (%g)$, %gx + %",a,c);

set([xl,yl,title(titleStr)],'Interpreter','LaTeX');
hold off