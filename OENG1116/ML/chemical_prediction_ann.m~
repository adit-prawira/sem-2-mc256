clear 
close all
clc

%% Training data set
fileName = "Datachemical.xlsx";
trainingSheetName = "Training";
inputTrainingDataRange = "A2:C73";
outputTrainingDataRange = "D2:D73";

trainingInput = xlsread(fileName, trainingSheetName, inputTrainingDataRange);
trainingOutput = xlsread(filename, trainingSheetName, outputTrainingDataRange);

x = trainingInput';
y= trainingOutput';

%% New data set
newDataSheetName = "Newdata";
inputNewDataRange = "A2:C4";
outputNewDataRange = "D2:D4";

newDataInput = xlsread(fileName, newDataSheetName, inputNewDataRange);
newDataOutput = xlsread(fileName, newDataSheetName, outputNewDataRange);

xNew = newDataInput';
yNew = newDataOutput';

%% ANN training with training data set
trainingFunction = "trainlm";
hiddenLayers = 10;

net = fitnet(hiddenLayers, trainingFunction);

net.input.processFcns = {'mapminmax'};
net.output.processFcns = {'mapminmax'};

net.divideMode = "sample";

net.divideParam.trainRatio = 0.7;
net.divideParam.valRatio = 0.2;
net.