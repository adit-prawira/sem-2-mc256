clear
close all
clc

%% Training data
fileName = "Datachemical.xlsx";
trainingSheetName = "Training";
trainingInputRange = "A2:C73";
trainingOutputRange = "D2:D73";

trainingInput = xlsread(fileName, trainingSheetName, trainingInputRange);
trainingOutput = xlsread(fileName, trainingSheetName, trainingOutputRange);

x = trainingInput'; 
y = trainingOutput'; 
%% New data set
newDataSheetName = "Newdata";
inputNewDataRange = "A2:C4";
outputNewDataRange = "D2:D4";

newDataInput = xlsread(fileName, newDataSheetName, inputNewDataRange);
newDataOutput = xlsread(fileName, newDataSheetName, outputNewDataRange);

xNew = newDataInput'; 
yNew = newDataOutput'; 

%% Standardization Training data sets
[xn, standardizeXn] = mapminmax(x);
[yn, standardizeYn] = mapminmax(y);

xnNew = mapminmax('apply', xNew, sxn);

xn = xn';
yn = yn';
xnNew = xnNew';

beta = [1 1 1 1 1 1 1 1]; % initialize coefficients

func = @(b,xn)b(1)+b(2)*xn(:,1)+b(3)*xn(:,2)+b(4)*xn(:,3)+...
    b(5 )*(xn(:,1).^2)+b(6)*((xn(:,1).*xn(:,2).*xn(:,3))+...
    b(7).*exp (b(8)*xn(:,3)));

model = fitnlm(xn, y)