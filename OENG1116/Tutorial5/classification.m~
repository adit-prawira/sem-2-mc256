clear
clc
close all
filename = 'classification.xlsx';
sheetread = 'x';
input1 = 'A1:I699';
sheetread1 = 't';
target1 = 'A1:B699';
input = xlsread(filename, sheetread, input1);
target = xlsread(filename, sheetread1, target1);
x=input';
t=target';

hiddenLayerSize = 10;
trainFcn = 'trainscg'; %Training function for classification
net = patternnet(hiddenLayerSize, trainFcn);  % Network Architecture
net.input.processFcns = {'mapminmax'}; % To standardize data 

RandStream.setGlobalStream (RandStream ('mrg32k3a'));

net.divideMode = 'sample'; 
net.divideParam.trainRatio = 70/100;
net.divideParam.valRatio = 15/100;
net.divideParam.testRatio = 15/100;

net.performFcn = 'crossentropy';  % Cross-Entropy for network perfoamnce

net.plotFcns = {'plotperform','plottrainstate','ploterrhist'};

[net,tr] = train(net,x,t);  % train the network
view(net)                 % view neural network
y = net(x);                % Compute predictions from the inputs 

e = gsubtract(t,y); % substract the real output with the output generated from 
